function StateColumnObject(name,value,type){this.Name=name;this.Value=value;this.Type=type;this.IsDirty=!1;type!="string"||value||(this.Value="");this.Equals=function(obj){if(this.IsDirty||this==null&&obj==null||this.Value==null&&obj.Value==null||this.Value===obj.Value)return!0;var origVal="",newVal="";switch(this.Type){case"datetime":case"date":this.Value!=""&&obj.Value!=""?(origVal=new Date(this.Value).getTime(),newVal=new Date(obj.Value).getTime()):(origVal=this.Value==null?"":this.Value,newVal=obj.Value==null?"":obj.Value);break;default:origVal=this.Value==null?"":this.Value;newVal=obj.Value==null?"":obj.Value}return newVal==origVal?!0:!1}}function OpenWindow(url,target,specs){var urlArr;target==undefined&&(target="_self");var tabKeQuery="tabkey="+GetTabKey(),SsoOidcQueryArgs=window.SsoOidc_QueryArgs,fullQueryArg=tabKeQuery;SsoOidcQueryArgs&&(fullQueryArg+="&"+SsoOidcQueryArgs);urlArr=url.split("?");urlArr.length>1?(url+="&",url+=urlArr[1].contains("tabkey")?SsoOidcQueryArgs:fullQueryArg):url+="?"+fullQueryArg;window.open(url,target,specs)}function ReplaceApostrophe(value){return value.replaceAll("'","''")}function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function Guid(){return(S4()+S4()+"-"+S4()+"-4"+S4().substr(0,3)+"-"+S4()+"-"+S4()+S4()+S4()).toLowerCase()}function FindArrayEntryByKey(arrayOfKeyValue,key,value){var entry=null;return $.each(arrayOfKeyValue,function(index,object){object[key]!=null&&object[key].toLowerCase()==value.toLowerCase()&&(entry=object)}),entry}function FindArrayEntryIndexByKey(arrayOfKeyValue,key,value){var entryIndex=-1;return $.each(arrayOfKeyValue,function(index,object){object[key]==value&&(entryIndex=index)}),entryIndex}function FindArrayEntryValueByKey(arrayOfKeyValue,keyFieldName,key,valueFieldName,defaultValue){return $.each(arrayOfKeyValue,function(index,object){object[keyFieldName]==key&&(defaultValue=object[valueFieldName])}),defaultValue}function UpdateFieldElement(field,elementName,elementValue){$.each(field.Elements,function(index,element){if(element.Key==elementName){element.Value=elementValue;return}})}function UnHideField(field){UpdateFieldElement(field,"hidden",!1);UpdateFieldElement(field,"visible",!0);field.Visible=!0}function HideField(field){UpdateFieldElement(field,"hidden",!1);UpdateFieldElement(field,"visible",!1);field.Visible=!1}function IsNullOrUndefined(object){return object==null|object==undefined|object=="null"?!0:!1}function CloneObject(object){return jQuery.extend(!0,{},object)}function Login(user,password,account,accountState,controlToBlock,forceLogin,supressCustomizer,userAcceptTerms,explicitCompanyId){var dataUrl=baseLink_LoginController+"/api-login",jsonLoginData={};jsonLoginData.user=user;jsonLoginData.password=password;jsonLoginData.account=account;jsonLoginData.accountState=accountState;jsonLoginData.explicitCompanyId="";jsonLoginData.supressCustomizer=!1;jsonLoginData.forceLogin=forceLogin==undefined?!1:forceLogin;jsonLoginData.userAcceptTerms=userAcceptTerms==undefined?!1:userAcceptTerms;explicitCompanyId!=undefined&&(jsonLoginData.explicitCompanyId=explicitCompanyId);supressCustomizer!=undefined&&(jsonLoginData.supressCustomizer=supressCustomizer);Astea.Framework.Ajax.MakeAjaxCall_UpdateData(dataUrl,jsonLoginData,controlToBlock,function(response){if(response.Error!=null){switch(response.Error.ButtonType){case"YesNo":showYesNoMessage(response.Error.ErrorMessage,function(){closeYesNoMessage();Login(user,password,account,accountState,controlToBlock,!0,!1,!1)},function(){closeYesNoMessage();return});break;default:if(response.Error.ErrorCode=="A2SEC147")return showTermsAndConditionsWindow(response.Error.ErrorMessage,function(){closeTermsAndConditionsWindow();var tmpUrl=window.location.href;$.each(["account","accountState","selfregcode","isVendor","tabkey"],function(idx,param){tmpUrl=removeParameter(tmpUrl,param)});window.history.replaceState({},window.document.title,tmpUrl);Login(user,password,account,accountState,controlToBlock,forceLogin,!1,!0)},function(){closeTermsAndConditionsWindow()}),"";if(response.Error.ErrorCode=="A2SEC148")return showCustomerSelectorWindow(response.ResponseData,function(){var customerId=$("#CustomerSelectorWindow").find("#customer-selector-list").val();customerId&&(closeCustomerSelectorWindow(),Login(user,password,account,accountState,controlToBlock,forceLogin,!1,!0,customerId))},function(){closeCustomerSelectorWindow()}),"";if(response.Error.ErrorCode=="CUSTOMIZER_LOGGED_MORE_THAN_ONCE")return showYesNoMessage(response.Error.ErrorMessage,function(){closeYesNoMessage();Login(user,password,account,accountState,controlToBlock,!0,!0,!1)},function(){closeYesNoMessage();Logout(!1);return}),"";if(response.Error.ErrorCode=="A2SEC144")return window.sessionStorage.setItem("accountState",accountState),window.sessionStorage.setItem("account",account),window.sessionStorage.setItem("username",user),window.sessionStorage.setItem("customerList",response.ResponseData),$("#changePasswordForm").submit(),"";showErrorMessage(response.Error.ErrorMessage,function(){$("#user").focus()})}return""}if(response.ExtraResponseItems!=null){var url=removeParameter(window.location.href,"account");url=removeParameter(url,"module");window.history.replaceState({},window.document.title,url);$.each(response.ExtraResponseItems,function(key,value){if(value.Key=="IsCustomizer"&&value.Value.toLowerCase()=="true")return showYesNoMessage(response.ResponseData,function(){closeYesNoMessage();var dataUrl=baseLink_PortalController+"/main"+window.location.search;OpenWindow(dataUrl)},function(){closeYesNoMessage();Logout(!1);return}),"";var dataUrl=baseLink_PortalController+"/main"+window.location.search;OpenWindow(dataUrl)})}})}function GetTabKey(){return $(".tab-key").text()}function GetPortalTitle(){return $(".portal-title").text()}function NavigateToLoginPage(){var urlParams=ParseUrlParams(),urlAccount=urlParams.account,accountByUrl=urlAccount!=undefined?"?account="+urlAccount:"",url=baseLink_SelfRegistrationController+"/login"+accountByUrl;OpenWindow(url)}function startSessionTimer(){timer=setInterval("IsSessionValid()",AsteaGlobals.Login.SessionValidationIntervalInMinutes)}function startHomePageRefreshTimer(){homePageTimer=setInterval("RelaodHomePage()",AsteaGlobals.Home.ReloadHomePageIntervalInMinutes)}function ConvertQbeRefreshIntervalToSeconds(timerInterval){var result;switch(timerInterval){case"15-s":case"30-s":case"1-m":result=6e4;break;case"5-m":result=3e5;break;case"10-m":result=6e5;break;default:result=0}return result}function IsSessionValid(){var dataUrl=baseLink_LoginController+"/api-is_session-valid";Astea.Framework.Ajax.MakeAjaxCall_GetData(dataUrl,"",!1,function(response){response.Error!=null&&Logout(!0);response.ResponseData==!1&&Logout(!0)})}function Logout(navigateToLoginPage){clearTimeout(timer);typeof Chat!="undefined"&&(Chat.CloseChat(),Chat.Disconnect());navigateToLoginPage!=null&&navigateToLoginPage!=undefined&&navigateToLoginPage==!0?($(window).unbind("beforeunload"),$.blockUI({message:"<img style='padding:10px;display:none' alt='loading...' src='../../Content/images/loading_big.gif' />"}),InternalLogout(function(){var dataUrl=baseLink_LoginController+"/logout";OpenWindow(dataUrl)})):InternalLogout()}function InternalLogout(callBackFunction){var url=baseLink_LoginController+"/api-logout";Astea.Framework.Ajax.MakeAjaxCall_GetData(url,"","",function(response){response.Error!=null&&console.log("logut with error - "+response.Error.ErrorMessage);console.log("logut done");callBackFunction!=null&&callBackFunction(!0)})}function Export(moduleName,boName,stateId,hostName,elementToBlock,callBackFunction){var url=baseLink_FrameworkController+"/export-state",jsonData={};jsonData.moduleName=moduleName;jsonData.boName=boName;jsonData.stateId=stateId;jsonData.hostName=hostName;Astea.Framework.Ajax.MakeAjaxCall_GetData(url,jsonData,elementToBlock,function(response){if(response.ResponseType=="Response-Error")return IsSessionTimeoutError(response)?null:(showErrorMessage(response.Error.ErrorMessage),null);callBackFunction(response.ResponseData)})}function ExportQuery(moduleName,searchCriteria,elementToBlock,callBackFunction){var url=baseLink_FrameworkController+"/export-query",jsonData={};jsonData.moduleName=moduleName;searchCriteria=searchCriteria.replaceAll("'","''");searchCriteria!=""&&(searchCriteria="'"+searchCriteria+"'");jsonData.searchCriteria=searchCriteria;Astea.Framework.Ajax.MakeAjaxCall_GetData(url,jsonData,elementToBlock,function(response){if(response.ResponseType=="Response-Error")return IsSessionTimeoutError(response)?null:(showErrorMessage(response.Error.ErrorMessage),null);callBackFunction(response.ResponseData)})}function DownloadFile(url){if(RunningByMobile())OpenWindow(url,"_blank");else{var hiddenIFrameID="hiddenDownloader",iframe=document.getElementById(hiddenIFrameID);iframe==null&&(iframe=document.createElement("iframe"),iframe.id=hiddenIFrameID,iframe.style.display="none",document.body.appendChild(iframe));iframe.src=url}}function RunningByMobile(){return/Android|webOS|iPhone|iPad|iPod|pocket|psp|kindle|avantgo|blazer|midori|Tablet|Palm|maemo|plucker|phone|BlackBerry|symbian|IEMobile|mobile|ZuneWP7|Windows Phone|Opera Mini/i.test(navigator.userAgent)}function CloseState(stateId,hostName,moduleName,elementToBlock){var jsonCloseState,closeStateUrl;stateId!=null&&stateId.length!=0&&(jsonCloseState={},jsonCloseState.stateId=stateId,jsonCloseState.moduleName=moduleName,jsonCloseState.hostName=hostName,closeStateUrl=baseLink_FrameworkController+"/close-state",Astea.Framework.Ajax.MakeAjaxCall_UpdateData(closeStateUrl,jsonCloseState,elementToBlock,function(response){if(response.Error!=null)return IsSessionTimeoutError(response)?null:(showErrorMessage(response.Error.ErrorMessage),null)}))}function IsModuleSupported(){return!0}function ExecuteQuery(entityName,queryName,sortCriteria,filterCriteria,elementToBlock,callBackFunction){var url=baseLink_FrameworkController+"/execute-query",jsonData={};jsonData.entityName=entityName;jsonData.queryName=queryName;jsonData.sortCriteria=sortCriteria;jsonData.filterCriteria=filterCriteria;Astea.Framework.Ajax.MakeAjaxCall_GetData(url,jsonData,elementToBlock,function(response){if(response.ResponseType=="Response-Error")return IsSessionTimeoutError(response)?null:(showErrorMessage(response.Error.ErrorMessage),null);if(callBackFunction!=null&&callBackFunction!=undefined)callBackFunction(response.Items);else return response.Items})}function GetPartData(partName,ignoreCache,callBackFunction){var url=baseLink_HomepageController+"/homepage-part",jsonData={};jsonData.partName=partName;jsonData.ignoreCache=ignoreCache;Astea.Framework.Ajax.MakeAjaxCall_GetData(url,jsonData,!1,function(response){if(response.ResponseType=="Response-Error")return IsSessionTimeoutError(response)?null:(showErrorMessage(response.Error.ErrorMessage),null);if(callBackFunction!=null&&callBackFunction!=undefined)callBackFunction(response.Items);else return response.Items})}function GetGadgetDataSource(partName,ignoreCache){var url=baseLink_HomepageController+"/homepage-part",jsonData={};return jsonData.partName=partName,jsonData.ignoreCache=ignoreCache,new kendo.data.DataSource({transport:{read:{url:url,dataType:"json",type:"POST",data:jsonData,beforeSend:function(req){req.setRequestHeader("tabkey",GetTabKey())}}},schema:{data:function(data){return data.ResponseType=="Response-Error"?IsSessionTimeoutError(data)?null:(showErrorMessage(data.Error.ErrorMessage),null):data.Items},total:function(data){return data.TotalCount}}})}function GetDefaultViewIndex(arrayOfViews){for(var defaultValue=0,i=0;i<arrayOfViews.length;i++)if(arrayOfViews[i].Visible==!0&&arrayOfViews[i].IsDefault==!0){defaultValue=i;break}return defaultValue}function IsEmployee(){var portalType=$.cookie("astea_PortalType");return portalType=="CustomerHTML5"}function IsCookieSessionVaid(gotoLoginPage){return(gotoLoginPage==null|gotoLoginPage==undefined&&(gotoLoginPage=!0),$.cookie("astea_SessionID")==null|$.cookie("astea_SessionID")=="")?(Logout(gotoLoginPage),!1):!0}function IsSessionTimeoutError(response){var sessionError=!1;return(response.Error.ErrorCode=="A2SEC009"||response.Error.ErrorMessage=="A2SEC009")&&(sessionError=!0,$.unblockUI(),showErrorMessage(response.Error.ErrorMessage,function(){NavigateToLoginPage()})),sessionError}function GetModuleDetails(moduleName){var modulesList=JSON.parse($(".modules-list-as-json").text());return FindArrayEntryByKey(modulesList,"ModuleName",moduleName)}function GetDdlbDataSource(entityName,queryName,module,sortCriteria,filterFields,enableEmptyValue,keyFieldName,displayFieldName){var ddlbUrl,postData;return AsteaLogger.WriteToLog("info","Framework",kendo.format("start loading ddlb data ({0} -> {1})",entityName,queryName),"",!1),ddlbUrl=baseLink_FrameworkController+"/execute-lookup",postData={},postData.entityName=entityName,postData.queryName=queryName,postData.module=module,postData.lookupColumns="",postData.sortCriteria=sortCriteria,postData.filterFields=filterFields==""|filterFields.length==0?"":JSON.stringify(filterFields),{transport:{cache:!1,read:{dataType:"json",url:ddlbUrl,type:"POST",data:postData,beforeSend:function(req){req.setRequestHeader("tabkey",GetTabKey())}}},schema:{data:function(data){var emptyitem,item;return data.ResponseType=="Response-Error"?IsSessionTimeoutError(data)?null:(showErrorMessage(data.Error.ErrorMessage),emptyitem={},emptyitem[keyFieldName]="",emptyitem[displayFieldName]="",[emptyitem]):(enableEmptyValue&&(item={},item[keyFieldName]="",item[displayFieldName]="",data.Items.unshift(item)),AsteaLogger.WriteToLog("info","Framework",kendo.format("finish loading ddlb data ({0} -> {1})",entityName,queryName),"",!0),data.Items)}}}}function GetLookupDataSource(entityName,queryName,module,lookupColumns,filterFields,sortCriteria,enableEmptyValue,keyFieldName,displayFieldName,lookupKeyFieldName,lookupDisplayFieldName){var ddlbUrl=baseLink_FrameworkController+"/execute-lookup",postData={};return postData.entityName=entityName,postData.queryName=queryName,postData.module=module,postData.lookupColumns=JSON.stringify(lookupColumns),postData.sortCriteria=sortCriteria,postData.filterFields=filterFields.length==0?"":JSON.stringify(filterFields),{requestStart:function(){AsteaLogger.WriteToLog("info","Framework",kendo.format("start loading lookup data ({0} -> {1})",entityName,queryName),"",!1)},serverFiltering:!0,ignoreCase:!1,transport:{cache:!1,read:{dataType:"json",url:ddlbUrl,type:"POST",data:postData,beforeSend:function(req){req.setRequestHeader("tabkey",GetTabKey())}}},schema:{data:function(data){var emptyitem,emptyItem;if(data.ResponseType=="Response-Error")return IsSessionTimeoutError(data)?null:(showErrorMessage(data.Error.ErrorMessage),emptyitem={},emptyitem[keyFieldName]="",emptyitem[displayFieldName]="",[emptyitem]);if(enableEmptyValue&data.Items.length>0){if(emptyItem={},data.Items.length>0)for(column in data.Items[0])emptyItem[column.toString()]="";emptyItem[keyFieldName]="";emptyItem[displayFieldName]="";displayFieldName.startsWith("FieldsConcatenation:")&&$.each(displayFieldName.replaceAll("FieldsConcatenation:","").split(","),function(fxFieldIndex,fxFieldName){emptyItem[fxFieldName]=""});data.Items.unshift(emptyItem)}return AsteaLogger.WriteToLog("info","Framework",kendo.format("finish loading lookup data ({0} -> {1})",entityName,queryName),"",!0),$.each(data.Items,function(index,item){keyFieldName!=lookupKeyFieldName&&(item[keyFieldName]=item[lookupKeyFieldName]);displayFieldName!=lookupDisplayFieldName&&(item[displayFieldName]=item[lookupDisplayFieldName])}),data.Items}}}}function ResetLookupField(sourceScreen,$scope,module,field,rowIndex,defaultResetValue){var lookupControl,pageMetaData,stateObject,maintStateObject,lookupAreaWidth,titleExists,obj,idx,stateData,sortCriteria,filterFields,ds;switch(sourceScreen.toLowerCase()){case"new":lookupControl=$scope.NewEntitiesLookups["lookup_"+module+"_"+field.Name];pageMetaData=$scope.ScreenData.NewEntities[module].PageMetadata;stateObject=$scope.ScreenData.NewEntities[module].Data[0];break;case"maint":lookupControl=$scope.ScreenLookups["lookup_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.PageMetaData;stateObject=$scope.ScreenData[module].Rows[rowIndex];break;case"xref":lookupControl=$scope.XrefLookups["lookup_"+field.ParentGroupName+"_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.Xref.maintPageMetaData;stateObject=$scope.Xref.entityMaint;break;case"new-xref":lookupControl=$scope.XrefNewLookups["lookup_"+field.ParentGroupName+"_"+field.Name];pageMetaData=$scope.Xref.newPageMetaData;stateObject=$scope.Xref.entityNew;break;case"maint-action":lookupControl=$scope.MaintActionsLookups["lookup_"+field.Name];pageMetaData=$scope.ActionWindowMetaData;stateObject=$scope.ActionsData;module!=null&&module.toLowerCase()!=="cp_basket"?maintStateObject=$scope.ScreenData[module].Rows[rowIndex]:module!=null&&module.toLowerCase()==="cp_basket"?(maintStateObject=$scope.BasketItems[rowIndex],maintStateObject=BuildStateObject(maintStateObject,pageMetaData)):maintStateObject=$scope.ActionsData;break;case"qbe-action":lookupControl=$scope.QBEActionsLookups["lookup_"+field.Name];pageMetaData=$scope.ActionsMetadata[field.Name];stateObject=$scope.ActionsData[field.Name];break;case"card":lookupControl=$scope.CardLookups["lookup_"+field.Name];pageMetaData=$scope.CardMetadata;stateObject=$scope.CardData[field.Name];break;case"promptwindow":lookupControl=$scope.XrefNewLookups["lookup_"+field.ParentGroupName+"_"+field.Name];pageMetaData=$scope.PageMetaData.PromptWindowTab;stateObject=$scope.Xref.entityNew}if(lookupControl==undefined){AsteaLogger.WriteToLog("error","FW",kendo.format("error while building {0} lookupControl",field.Name),"",!1);return}lookupAreaWidth=0;titleExists=!0;$.each(field.Lookup.LookupColumns,function(index,lookupColumn){lookupColumn.Element_columnwidth!=null&&(lookupAreaWidth+=parseInt(lookupColumn.Element_columnwidth));titleExists=lookupColumn.Title.length>0});obj=lookupControl.wrapper.closest(".maint-entity-group-field-cell");titleExists?lookupAreaWidth<=525?lookupControl.list.addClass("maint-lookup-list-area"):lookupControl.list.css("width",lookupAreaWidth+"px"):lookupControl.list.css("width","250px");defaultResetValue!=undefined&&lookupControl.value(defaultResetValue);lookupControl.unbind("dataBound");lookupControl.unbind("change");lookupControl.unbind("open");$scope.EnablePageEditing===!1&&sourceScreen.toLowerCase()!="maint-action"&&lookupControl.enable(!1);idx=FindArrayEntryIndexByKey(field.Lookup.LookupColumns,"Element_displayonly","true");stateData={};sourceScreen.toLowerCase()!="maint-action"&&sourceScreen.toLowerCase()!="qbe-action"&&idx==-1&&($.each(field.Lookup.LookupColumns,function(index,lookupColumn){stateData[lookupColumn.Name]=stateObject[lookupColumn.Name]==null?"":stateObject[lookupColumn.Name].Value}),stateData[field.Lookup.LookupAttribute_displayvalue]=stateObject[field.Lookup.LookupAttribute_displayvalue]==null?"":stateObject[field.Lookup.LookupAttribute_displayvalue].Value,stateData[field.Lookup.LookupAttribute_keyvalue]=stateObject[field.Lookup.LookupAttribute_keyvalue]==null?"":stateObject[field.Lookup.LookupAttribute_keyvalue].Value);sourceScreen.toLowerCase()=="maint-action"&&($.each(field.Lookup.LookupColumns,function(index,lookupColumn){stateData[lookupColumn.Name]=maintStateObject[lookupColumn.Name]==null?"":maintStateObject[lookupColumn.Name].Value}),stateData[field.Lookup.LookupAttribute_displayvalue]=maintStateObject[field.Lookup.LookupAttribute_displayvalue]==null?"":maintStateObject[field.Lookup.LookupAttribute_displayvalue].Value,stateData[field.Lookup.LookupAttribute_keyvalue]=maintStateObject[field.Lookup.LookupAttribute_keyvalue]==null?"":maintStateObject[field.Lookup.LookupAttribute_keyvalue].Value);lookupControl.setDataSource(new kendo.data.DataSource({data:[stateData]}));sortCriteria="";field.Lookup.LookupAttribute_sortcolumn!=""&&(sortCriteria=field.Lookup.LookupAttribute_sortcolumn+" "+field.Lookup.LookupAttribute_sortdirection);filterFields=[];field.Lookup.FilterFields!=null&&field.Lookup.FilterFields.length>0&&$.each(field.Lookup.FilterFields,function(index,filterField){var filterFieldType=pageMetaData.AllFieldsTypes[filterField.Name]?pageMetaData.AllFieldsTypes[filterField.Name].FieldAttribute_type:"string",filterFieldName=filterField.Name,filterFieldAlias=filterField.Alias==""|filterField.Alias==null?filterField.Name:filterField.Alias,currentSate=maintStateObject,filterField;stateObject!=null&&stateObject[filterFieldName]!=null&&(currentSate=BuildStateObject(stateObject,pageMetaData));currentSate[filterFieldName]!=null&&currentSate[filterFieldName].Value!=null&&currentSate[filterFieldName].Value.toString()!=""&&(filterField={},filterField.FieldType=filterFieldType.toString(),filterField.FieldName=filterFieldAlias.toString(),filterField.FieldValue=currentSate[filterFieldName].Value.toString(),filterField.FieldOperator=field.Lookup.LookupAttribute_operator==null?"":field.Lookup.LookupAttribute_operator,filterFields.push(filterField))});ds=GetLookupDataSource(field.Lookup.LookupAttribute_entityname!=null?field.Lookup.LookupAttribute_entityname:"",field.Lookup.LookupAttribute_queryname!=null?field.Lookup.LookupAttribute_queryname:"",field.Lookup.LookupAttribute_module!=null?field.Lookup.LookupAttribute_module:"",field.Lookup.LookupColumns,filterFields,sortCriteria,field.Lookup.LookupAttribute_enableemptyvalue==null?!0:field.Lookup.LookupAttribute_enableemptyvalue.toString().toLowerCase()=="true",field.Lookup.LookupAttribute_keyvalue,field.Lookup.LookupAttribute_displayvalue,field.Lookup.LookupKeyValue,field.Lookup.LookupDisplayValue==null?field.Lookup.LookupKeyValue:field.Lookup.LookupDisplayValue);lookupControl.bind("change",function(){var selectedText=this.text(),descrFieldName=field.Lookup.LookupAttribute_displayvalue;if(descrFieldName!=undefined)switch(sourceScreen.toLowerCase()){case"xref":$scope.XrefLookupsDisplayData[descrFieldName]=selectedText}});field.Lookup.LookupAttribute_nodatamessage!=undefined&&field.Lookup.LookupAttribute_nodatamessage.length>0&&lookupControl.bind("dataBound",function(e){var msg=AsteaUI.GetTranslatedLabel(field.Lookup.LookupAttribute_nodatamessage,field.Lookup.LookupAttribute_nodatamessage),lookupItems=e.sender.dataSource._data.length;e.sender.ul.parent().find(".no-records").remove();lookupItems==0&&e.sender.ul.parent().append("<div class='no-records' >"+msg+"<\/div>")});field.Lookup.ResetFields!=null&&field.Lookup.ResetFields.length>0&&lookupControl.bind("change",function(){$.each(field.Lookup.ResetFields,function(index,resetField){var resetFieldName=resetField.Name,defaultResetValue=FindArrayEntryValueByKey(resetField.Attributes,"Key","defaultresetvalue","Value",""),resetField=pageMetaData.AllFields[resetField.Name];switch(resetField.FieldAttribute_type.toLowerCase()){case"lookup":ResetLookupField(sourceScreen,$scope,module,resetField,rowIndex,defaultResetValue);break;case"ddlb":ResetDdlbField(sourceScreen,$scope,module,resetField,rowIndex,defaultResetValue)}stateObject[resetField.Name].Value!=undefined&&(stateObject[resetField.Name].Value=defaultResetValue);stateObject[resetField.Name]!=undefined&&(stateObject[resetField.Name].Value=defaultResetValue);$scope.$apply()})});lookupControl.one("open",function(){var emptyDataSource=new kendo.data.DataSource({data:[]});lookupControl.setDataSource(ds)})}function IsXrefFormValid($scope){var valid=!0;return $scope.Xref==null||$scope.Xref.MandatoryValues.length==0?valid:($.each($scope.Xref.MandatoryValues,function(name,value){value&&(valid=!1)}),valid)}function UpdateXrefFormValid($scope,controlName,valid){$scope.Xref!=null&&$scope.Xref.MandatoryValues.length!=0&&$.each($scope.Xref.MandatoryValues,function(name){name==controlName&&($scope.Xref.MandatoryValues[name]=valid)})}function OnDdlbLookupChange(sourceScreen,dependencyFields,$scope,rowIndex){var currenttDomElement,disablePage,needResize;rowIndex==undefined&&(rowIndex=0);$scope.Xref||($scope.Xref={});disablePage=$scope.DisableXrefPage?$scope.DisableXrefPage:!1;$scope.Xref.MandatoryValues={};var useDontPromptValues=!1,metaData=null,stateObject=null;switch(sourceScreen.toLowerCase()){case"maint":metaData=$scope.PageMetaData;currenttDomElement=$scope.DomElement;stateObject=$scope.ScreenData.main.Rows[rowIndex];break;case"maint-xref":metaData=$scope.Xref.maintPageMetaData;currenttDomElement=$scope.DomElement;stateObject=$scope.Xref.entityMaint;break;case"maint-action":metaData={};metaData.Tabs=[];metaData.Tabs.push($scope.ActionWindowMetaData);currenttDomElement=$scope.ActionDomElement;stateObject=$scope.ActionsData;break;case"new":metaData=$scope.ScreenData.NewEntities[$scope.ScreenGlobals.Module].PageMetadata;currenttDomElement=$scope.DomElement;stateObject=$scope.ScreenData.NewEntities[$scope.ScreenGlobals.Module].Data[0];break;case"new-xref":metaData=$scope.Xref.newPageMetaData;currenttDomElement=$scope.DomElement;stateObject=$scope.Xref.entityNew;break;case"promptwindow":metaData={};metaData.Tabs=[];metaData.Tabs.push($scope.PageMetaData.PromptWindowTab);currenttDomElement=$scope.PromptDomElement;stateObject=$scope.Xref.entityNew;useDontPromptValues=!0}if(needResize=!1,$.each(dependencyFields,function(idx,dependencyField){var targetFieldsControls={},targetGroupsControls={},sourceFieldsControls={},controlTypes={},dependencyTabContainerName=dependencyField.ParentTabName,valid,validMandatory;$.each(dependencyField.SourceFields,function(idx,sourceFieldName){var sourceField=AsteaMetadata.FindField(metaData,dependencyTabContainerName,"",sourceFieldName),sourceFieldType=sourceField?sourceField.FieldAttribute_type:"",sourceControl=null,controlName="",isStaticDdlb,groupName;switch(sourceScreen.toLowerCase()){case"maint":switch(sourceFieldType.toLowerCase()){case"ddlb":isStaticDdlb=sourceField.Lookup.LookupAttribute_ddlbtype=="static";sourceControl=isStaticDdlb==!1?$scope.ScreenDDLBs["ddlb_"+sourceFieldName+"_index_0"]:$scope.ScreenDDLBs["ddlb_"+sourceFieldName];break;case"lookup":sourceControl=$scope.ScreenLookups["lookup_"+sourceFieldName+"_index_0"];break;case"duration":sourceControl=$scope.DurationDDLBs["ddlb_"+sourceFieldName+"_index_0"];break;default:sourceFieldType==""?sourceControl=null:(controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=currenttDomElement.find("."+controlName))}break;case"maint-action":switch(sourceFieldType.toLowerCase()){case"ddlb":case"duration":sourceControl=$scope.MaintActionsDDLBs["ddlb_"+sourceFieldName];break;case"lookup":sourceControl=$scope.MaintActionsLookups["lookup_"+sourceFieldName];break;default:sourceFieldType==""?sourceControl=null:(controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=$scope.ActionDomElement.find("."+controlName))}break;case"maint-xref":groupName=sourceField.ParentGroupName+"_"+sourceFieldName;switch(sourceFieldType.toLowerCase()){case"ddlb":isStaticDdlb=sourceField.Lookup.LookupAttribute_ddlbtype=="static";sourceControl=isStaticDdlb==!1?$scope.XrefDDLBs["ddlb_"+sourceFieldName+"_index_"+rowIndex.toString()]:$scope.XrefDDLBs["ddlb_"+sourceFieldName];break;case"lookup":sourceControl=$scope.XrefLookups["lookup_"+groupName+"_index_"+rowIndex.toString()];break;case"duration":sourceControl=$scope.XrefDurationDDLBs["ddlb_"+sourceFieldName+"_index_"+rowIndex.toString()];break;default:sourceFieldType==""?sourceControl=null:(controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=$(".xrefMaintPage").find("."+controlName))}break;case"new":switch(sourceFieldType.toLowerCase()){case"ddlb":sourceControl=$scope.NewEntitiesDdlbs["ddlb_"+$scope.ScreenGlobals.Module+"_"+sourceFieldName];break;case"lookup":sourceControl=$scope.NewEntitiesLookups["lookup_"+$scope.ScreenGlobals.Module+"_"+sourceFieldName];break;case"duration":sourceControl=$scope.NewDurationDDLBs["ddlb_"+$scope.ScreenGlobals.Module+"_"+sourceFieldName];break;default:sourceFieldType==""?sourceControl=null:(controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=$(".new-entity-container").find("."+controlName))}break;case"new-xref":case"promptwindow":switch(sourceFieldType.toLowerCase()){case"ddlb":sourceControl=$scope.XrefNewDDLBs["ddlb_"+sourceField.ParentGroupName+"_"+sourceFieldName];break;case"lookup":sourceControl=$scope.XrefNewLookups["lookup_"+sourceField.ParentGroupName+"_"+sourceFieldName];break;case"duration":sourceControl=$scope.XrefNewDurationDDLBs["ddlb_"+sourceFieldName+"_index_"+rowIndex.toString()];break;default:sourceFieldType==""?sourceControl=null:(controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=$(".new-entity-container").find("."+controlName))}}sourceControl&&sourceControl.length!=0||AsteaLogger.WriteToLog("error","FW",kendo.format("Couldn't found control {0}, check condition/field defintion in MD",sourceFieldName),"",!1);sourceFieldsControls[sourceFieldName]=sourceControl;controlTypes[sourceFieldName]=sourceFieldType.toLowerCase()});$.each(dependencyField.TargetFields,function(idx,targetFieldName){var targetField=AsteaMetadata.FindField(metaData,dependencyTabContainerName,"",targetFieldName),mandatoryByMd=!targetField||targetField.FieldAttribute_mandatory==undefined?!1:targetField.FieldAttribute_mandatory=="true",groupName,containerName;if(targetField!=undefined&&!mandatoryByMd){var targetFieldType=targetField&&targetField.FieldAttribute_type?targetField.FieldAttribute_type.toLowerCase():"",targetControl=null,controlName="";switch(sourceScreen.toLowerCase()){case"maint":switch(targetFieldType){case"ddlb":targetControl=$scope.ScreenDDLBs["ddlb_"+targetFieldName+"_index_0"];break;case"lookup":targetControl=$scope.ScreenLookups["lookup_"+targetFieldName+"_index_0"];break;case"duration":targetControl=$scope.DurationDDLBs["ddlb_"+targetFieldName+"_index_0"];break;default:targetFieldType==""?targetControl=null:(controlName=kendo.format("{0}_{1}",targetField.ParentGroupName,targetField.Name),targetControl=$scope.DomElement.find("."+controlName))}break;case"maint-action":switch(targetFieldType){case"ddlb":case"duration":targetControl=$scope.MaintActionsDDLBs["ddlb_"+targetFieldName];break;case"lookup":targetControl=$scope.MaintActionsLookups["lookup_"+targetFieldName];break;default:targetFieldType==""?targetControl=null:(controlName=kendo.format("{0}_{1}",targetField.ParentGroupName,targetField.Name),targetControl=$scope.ActionDomElement.find("."+controlName))}break;case"maint-xref":groupName=targetField.ParentGroupName+"_"+targetFieldName;switch(targetFieldType){case"ddlb":targetControl=$scope.XrefDDLBs["ddlb_"+targetFieldName+"_index_"+rowIndex.toString()];break;case"lookup":targetControl=$scope.XrefLookups["lookup_"+groupName+"_index_"+rowIndex.toString()];break;case"duration":targetControl=$scope.XrefDurationDDLBs["ddlb_"+targetFieldName+"_index_"+rowIndex.toString()];break;default:targetFieldType==""?targetControl=null:(controlName=kendo.format("{0}_{1}",targetField.ParentGroupName,targetField.Name),targetControl=$(".xrefMaintPage").find("."+controlName))}break;case"new":switch(targetFieldType){case"ddlb":targetControl=$scope.NewEntitiesDdlbs["ddlb_"+$scope.ScreenGlobals.Module+"_"+targetFieldName];break;case"lookup":targetControl=$scope.NewEntitiesLookups["lookup_"+$scope.ScreenGlobals.Module+"_"+targetFieldName];break;case"duration":targetControl=$scope.NewDurationDDLBs["ddlb_"+$scope.ScreenGlobals.Module+"_"+targetFieldName];break;default:targetFieldType==""?targetControl=null:(controlName=kendo.format("{0}_{1}",targetField.ParentGroupName,targetField.Name),targetControl=$(".new-entity-container").find("."+controlName))}break;case"new-xref":case"promptwindow":switch(targetFieldType.toLowerCase()){case"ddlb":targetControl=$scope.XrefNewDDLBs["ddlb_"+targetField.ParentGroupName+"_"+targetFieldName];break;case"lookup":targetControl=$scope.XrefNewLookups["lookup_"+targetField.ParentGroupName+"_"+targetFieldName];break;case"duration":targetControl=$scope.XrefNewDurationDDLBs["ddlb_"+targetFieldName+"_index_"+rowIndex.toString()];break;default:targetFieldType==""?targetControl=null:(controlName=kendo.format("{0}_{1}",targetField.ParentGroupName,targetField.Name),containerName=sourceScreen.toLowerCase()=="promptwindow"?"prompt-popup-container":"new-entity-container",targetControl=$("."+containerName).find("."+controlName))}}targetControl&&targetControl.length!=0||AsteaLogger.WriteToLog("error","FW",kendo.format("Couldn't found control {0}, check condition/field defintion in MD",targetFieldName),"",!1);targetFieldsControls[targetFieldName]=targetControl;controlTypes[targetFieldName]=targetFieldType}});$.each(dependencyField.TargetGroups,function(idx,targetGroupName){var targetGroupControl=currenttDomElement.find("div[group-name='"+targetGroupName+"']");targetGroupControl.length>0&&(targetGroupsControls[targetGroupName]=targetGroupControl)});var onChangeCondition=dependencyField.Condition,action=dependencyField.Action,tempIdx=0;if($.each(sourceFieldsControls,function(name,sourceFieldsControl){var controlValue,currentValue,controlType,fieldName;if(sourceFieldsControl||stateObject[name]==undefined||(controlValue=stateObject[name].Value),currentValue="",controlType=controlTypes[name],useDontPromptValues)fieldName=name.replace("field[","").replace("]",""),currentValue=stateObject[fieldName].Value;else switch(controlType.toLowerCase()){case"ddlb":case"lookup":case"duration":currentValue=controlValue==null?sourceFieldsControl.value():controlValue;break;default:currentValue=controlValue==null?sourceFieldsControl[0].value:controlValue}tempIdx==0&&AsteaLogger.WriteToLog("info","FW",kendo.format("Field condition before populating values {0}",onChangeCondition),"",!1);useDontPromptValues?(stateObject[name]||(onChangeCondition=onChangeCondition.replaceAll("field["+name+"]",currentValue)),onChangeCondition=ConvertConditionByStateValues(onChangeCondition,stateObject)):$.isNumeric(currentValue)?(onChangeCondition=onChangeCondition.replaceAll("field["+name+"]",currentValue),onChangeCondition.contains("field[")&&(onChangeCondition=ConvertConditionByStateValues(onChangeCondition,stateObject))):(onChangeCondition=onChangeCondition.replaceAll("field["+name+"]","'"+currentValue.trim()+"'"),onChangeCondition.contains("field[")&&(onChangeCondition=ConvertConditionByStateValues(onChangeCondition,stateObject)));tempIdx++}),onChangeCondition=ConvertConditionOperators(onChangeCondition),AsteaLogger.WriteToLog("info","FW",kendo.format("Field condition after populating values {0}",onChangeCondition),"",!1),onChangeCondition!=dependencyField.Condition){try{valid=$scope.$eval(onChangeCondition)}catch(e){AsteaLogger.WriteToLog("error","FW",kendo.format("Fail to evaluate condition {0} Error {1}",onChangeCondition,e.message),!1);return}validMandatory=valid;$.each(targetGroupsControls,function(name,targetGroupControl){var actions=action.split(";");$.each(actions,function(idx,act){switch(act.toLowerCase()){case"hide":valid&&(targetGroupControl.addClass("hide"),needResize=!0);break;case"show":valid&&(targetGroupControl.removeClass("hide"),needResize=!0);break;case"enable":disablePage||valid&&targetGroupControl.removeClass("disabled-div");break;case"disable":disablePage||valid&&targetGroupControl.addClass("disabled-div")}})});$.each(targetFieldsControls,function(name,targetFieldControl){var className,controlType,actions;if(validMandatory=valid,className=sourceScreen.toLowerCase()=="new"?"new-entity-field-container":"maint-entity-group-field-container",sourceScreen.toLowerCase()=="maint-xref"&&(className="maint-entity-group-field-container"),targetFieldControl!=undefined){if(controlType=controlTypes[name],controlType!="ddlb"&&controlType!="lookup"&&targetFieldControl.length==0)return;actions=action.split(";");$.each(actions,function(idx,act){var objectContainer;switch(act.toLowerCase()){case"mandatory":switch(controlType){case"ddlb":case"lookup":case"duration":targetFieldControl.value().length>0&&(validMandatory=!1);break;default:targetFieldControl[0].value.length>0&&(validMandatory=!1)}switch(controlType){case"ddlb":case"duration":validMandatory?(targetFieldControl.wrapper.addClass("ng-invalid").addClass("ng-invalid-required"),targetFieldControl.wrapper.removeClass("ng-valid").removeClass("ng-valid-required")):(targetFieldControl.wrapper.removeClass("ng-invalid").removeClass("ng-invalid-required"),targetFieldControl.wrapper.addClass("ng-valid").addClass("ng-valid-required"));break;case"lookup":validMandatory?(targetFieldControl.wrapper.find("select").addClass("ng-invalid").addClass("ng-invalid-required"),targetFieldControl.wrapper.find("select").removeClass("ng-valid").removeClass("ng-valid-required")):(targetFieldControl.wrapper.find("select").removeClass("ng-invalid").removeClass("ng-invalid-required"),targetFieldControl.wrapper.find("select").addClass("ng-valid").addClass("ng-valid-required"));break;default:validMandatory?(targetFieldControl.addClass("ng-invalid").addClass("ng-invalid-required"),targetFieldControl.removeClass("ng-valid").removeClass("ng-valid-required")):(targetFieldControl.removeClass("ng-invalid").removeClass("ng-invalid-required"),targetFieldControl.addClass("ng-valid").addClass("ng-valid-required"))}$scope.Xref.MandatoryValues[name]=validMandatory;break;case"hide":switch(controlType){case"ddlb":case"lookup":case"duration":objectContainer=targetFieldControl.wrapper!=undefined?targetFieldControl.wrapper.closest("."+className):targetFieldControl.closest("."+className);valid&&(objectContainer.hide(),dependencyField.Empty&&targetFieldControl.value().length>0&&targetFieldControl.value(""));break;default:valid&&targetFieldControl.closest("."+className).addClass("hide")}needResize=!0;break;case"show":switch(controlType){case"ddlb":case"lookup":case"duration":objectContainer=targetFieldControl.wrapper!=undefined?targetFieldControl.wrapper.closest("."+className):targetFieldControl.closest("."+className);valid&&(objectContainer.show(),dependencyField.Empty&&targetFieldControl.value().length>0&&targetFieldControl.value(""));break;default:valid&&targetFieldControl.closest("."+className).removeClass("hide")}needResize=!0;break;case"disable":switch(controlType){case"ddlb":case"lookup":case"duration":disablePage||(valid?targetFieldControl.enable(!1):targetFieldControl.enable());break;default:disablePage||(valid?targetFieldControl.prop("disabled",!0):targetFieldControl.prop("disabled",!1))}break;case"enable":switch(controlType){case"ddlb":case"lookup":case"duration":disablePage||(valid?targetFieldControl.enable():(targetFieldControl.enable(!1),dependencyField.Empty&&targetFieldControl.value().length>0&&targetFieldControl.value("")));break;default:disablePage||(valid?(targetFieldControl.prop("disabled",!1),validMandatory=!1):(targetFieldControl.prop("disabled",!0),dependencyField.Empty&&targetFieldControl[0].value.length>0&&(targetFieldControl[0].value="")))}}controlType=="string"|controlType=="number"|controlType=="decimal"|controlType=="text"|controlType=="currency"|controlType=="numeric"?valid&&validMandatory&&dependencyField.Empty&&targetFieldControl[0].value.length>0&&(targetFieldControl[0].value="",stateObject[name].Value=""):controlType.startsWith("date")|controlType=="time"?valid&&validMandatory&&dependencyField.Empty&&targetFieldControl[1].value.length>0&&(targetFieldControl[1].value="",stateObject[name].Value=""):act.toLowerCase()=="disable"&&valid&&dependencyField.Empty&&targetFieldControl.value().length>0&&(targetFieldControl.value(""),stateObject[name].Value="")})}})}}),needResize)switch(sourceScreen.toLowerCase()){case"maint":case"maint-action":case"promptwindow":ResizeTabstripContainer(!0);break;case"maint-xref":$scope.ResizeXrefMaintWindow()}}function OnChangeInputType(sourceField,sourceScreen,pageName,$scope){var controlName=kendo.format("{0}_{1}",sourceField.ParentGroupName,sourceField.Name),sourceControl=null;switch(sourceScreen.toLowerCase()){case"maint":sourceControl=$scope.DomElement.find("."+controlName);break;case"maint-xref":sourceControl=$(".xrefMaintPage").find("."+controlName)}sourceControl!=null&&(sourceControl[0].value.length==0?(sourceControl.addClass("ng-invalid").addClass("ng-invalid-required"),sourceControl.removeClass("ng-valid").removeClass("ng-valid-required"),sourceScreen!="Maint"&&UpdateXrefFormValid($scope,sourceField.Name,!0)):(sourceControl.removeClass("ng-invalid").removeClass("ng-invalid-required"),sourceControl.addClass("ng-valid").addClass("ng-valid-required"),sourceScreen!="Maint"&&UpdateXrefFormValid($scope,sourceField.Name,!1)))}function ApplyDependenciesFieldsConditions(sourceScreen,boName,$scope,isActionWindow){var pageMetadata=$scope.PageMetaData,currentTab;isActionWindow!=undefined&&isActionWindow===!0&&(pageMetadata=$scope.ActionWindowMetaData);sourceScreen.toLowerCase()=="maint-xref"&&(pageMetadata=$scope.Xref.maintPageMetaData);sourceScreen.toLowerCase()=="new"&&(pageMetadata=$scope.ScreenData.NewEntities[$scope.ScreenGlobals.Module].PageMetadata);sourceScreen.toLowerCase()=="new-xref"&&(pageMetadata=$scope.Xref.newPageMetaData);currentTab=null;currentTab=isActionWindow!=undefined&&isActionWindow===!0?$scope.ActionWindowMetaData:Astea.Framework.Metadata.FindTabByBoName(pageMetadata,boName);sourceScreen.toLowerCase()=="promptwindow"&&(currentTab=$scope.PageMetaData.PromptWindowTab);currentTab!=null&&currentTab.DependencyFields!=null&&currentTab.DependencyFields.length>0&&OnDdlbLookupChange(sourceScreen,currentTab.DependencyFields,$scope)}function ApplyDurationFields(scope,domElement){var durationObjects=domElement?domElement.find(".ddlb-duration"):scope.DomElement.find(".ddlb-duration");$.each(durationObjects,function(idx,duration){var fieldName=$(duration).attr("ddlb-duration"),rowIndex,sourceScreen;fieldName&&(rowIndex=$(duration).closest(".maint-entity-group-fields-container").attr("row-index"),sourceScreen=$(duration).attr("source-screen"),scope.FillDurationDdlb(fieldName,rowIndex,sourceScreen))})}function ApplyDdlbDurationForamt(sourceScreen,$scope,module,field,rowIndex,setValue){var ddlbControl,pageMetaData,stateObject,conditionFieldName,setStateValue;switch(sourceScreen.toLowerCase()){case"new":ddlbControl=$scope.NewDurationDDLBs["ddlb_"+module+"_"+field.Name];pageMetaData=$scope.ScreenData.NewEntities[module].PageMetadata;stateObject=$scope.ScreenData.NewEntities[module].Data[0];break;case"maint":ddlbControl=$scope.DurationDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.PageMetaData;stateObject=$scope.ScreenData[module].Rows[rowIndex];break;case"maint-xref":ddlbControl=$scope.XrefDurationDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.Xref.maintPageMetaData;stateObject=$scope.Xref.entityMaint;break;case"new-xref":ddlbControl=$scope.XrefNewDurationDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.Xref.newPageMetaData;stateObject=$scope.Xref.entityNew;break;case"maint-action":ddlbControl=$scope.MaintActionsDDLBs["ddlb_"+field.Name];pageMetaData=$scope.ActionWindowMetaData;stateObject=$scope.ActionsData[field.Name];break;case"qbe-action":ddlbControl=$scope.QBEActionsDDLBs["ddlb_"+field.Name];pageMetaData=$scope.ActionsMetadata[field.Name];stateObject=$scope.ActionsData[field.Name];break;case"card":ddlbControl=$scope.CardDDLBs["ddlb_"+field.Name];pageMetaData=$scope.CardMetadata;stateObject=$scope.CardData;break;case"promptwindow":ddlbControl=$scope.XrefNewDurationDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.PageMetaData.PromptWindowTab;stateObject=$scope.Xref.entityNew}if(ddlbControl==undefined){AsteaLogger.WriteToLog("error","FW",kendo.format("error while building {0} DDLB",field.Name),"",!1);return}ddlbControl.unbind("dataBound");ddlbControl.unbind("change");conditionFieldName=kendo.format("{0}_{1}",field.ParentGroupName,field.Name);$scope.EnablePageEditing===!1&&sourceScreen.toLowerCase()!="maint-action"&&ddlbControl.enable(!1);setStateValue="";setValue&&(setStateValue=stateObject[field.Name].Value,ddlbControl.value(AsteaUI.FormatTimeDuration(setStateValue)),$(ddlbControl).attr("title",ddlbControl.value()));ddlbControl.bind("change",function(){var isValidValue=AsteaUI.ForamtTimeToDuration(ddlbControl.value()),conditionAttribute,selectedValue;if(isValidValue||(setStateValue=stateObject[field.Name].Value),conditionAttribute=ddlbControl.wrapper.closest("[condition='"+conditionFieldName+"']"),conditionAttribute&&$scope.TriggerDependencies===!0&&ApplyDependenciesFieldsConditions(sourceScreen.toLowerCase(),$scope.ScreenGlobals.CurrentBoName,$scope),selectedValue=AsteaUI.ConvertDurationToTime(ddlbControl.value()),selectedValue!=null){$(ddlbControl).attr("title",ddlbControl.value());switch(sourceScreen.toLowerCase()){case"new":$scope.ScreenData.NewEntities[module].Data[0][field.Name].Value=selectedValue;break;case"maint":$scope.ScreenData[module].Rows[rowIndex][field.Name].Value=selectedValue;break;case"maint-xref":$scope.Xref.entityMaint[field.Name].Value=selectedValue;break;case"new-xref":case"promptwindow":$scope.Xref.entityNew[field.Name].Value=selectedValue;break;case"maint-action":$scope.ActionsData[field.Name].Value=selectedValue;break;case"qbe-action":$scope.ActionsData[field.Name].Value=selectedValue;break;case"card":$scope.CardData[field.Name].Value=selectedValue}ddlbControl.value(AsteaUI.FormatTimeDuration(selectedValue))}})}function ResetDdlbField(sourceScreen,$scope,module,field,rowIndex,defaultResetValue){var ddlbControl,pageMetaData,stateObject,sortCriteria,filterFields,ds,emptyDataSource;switch(sourceScreen.toLowerCase()){case"new":ddlbControl=$scope.NewEntitiesDdlbs["ddlb_"+module+"_"+field.Name];pageMetaData=$scope.ScreenData.NewEntities[module].PageMetadata;stateObject=$scope.ScreenData.NewEntities[module].Data[0];break;case"maint":ddlbControl=$scope.ScreenDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.PageMetaData;stateObject=$scope.ScreenData[module].Rows[rowIndex];break;case"xref":ddlbControl=$scope.XrefDDLBs["ddlb_"+field.Name+"_index_"+rowIndex.toString()];pageMetaData=$scope.Xref.maintPageMetaData;stateObject=$scope.Xref.entityMaint;break;case"new-xref":ddlbControl=$scope.XrefNewDDLBs["ddlb_"+field.ParentGroupName+"_"+field.Name];pageMetaData=$scope.Xref.newPageMetaData;stateObject=$scope.Xref.entityNew;break;case"maint-action":ddlbControl=$scope.MaintActionsDDLBs["ddlb_"+field.Name];pageMetaData=$scope.ActionWindowMetaData;stateObject=$scope.ActionsData[field.Name];break;case"qbe-action":ddlbControl=$scope.QBEActionsDDLBs["ddlb_"+field.Name];pageMetaData=$scope.ActionsMetadata[field.Name];stateObject=$scope.ActionsData[field.Name];break;case"card":ddlbControl=$scope.CardDDLBs["ddlb_"+field.Name];pageMetaData=$scope.CardMetadata;stateObject=$scope.CardData;break;case"promptwindow":ddlbControl=$scope.XrefNewDDLBs["ddlb_"+field.ParentGroupName+"_"+field.Name];pageMetaData=$scope.PageMetaData.PromptWindowTab;stateObject=$scope.Xref.entityNew}if(ddlbControl==undefined){AsteaLogger.WriteToLog("error","FW",kendo.format("error while building {0} DDLB",field.Name),"",!1);return}ddlbControl.unbind("dataBound");$scope.EnablePageEditing===!1&&sourceScreen.toLowerCase()!="maint-action"&&ddlbControl.enable(!1);sortCriteria="";field.Lookup.LookupAttribute_sortcolumn!=""&&(sortCriteria=field.Lookup.LookupAttribute_sortcolumn+" "+field.Lookup.LookupAttribute_sortdirection);filterFields=[];field.Lookup.FilterFields!=null&&field.Lookup.FilterFields.length>0&&$.each(field.Lookup.FilterFields,function(index,filterField){var filterFieldType=pageMetaData.AllFieldsTypes[filterField.Name]?pageMetaData.AllFieldsTypes[filterField.Name].FieldAttribute_type:"string",filterFieldName=filterField.Name,filterFieldAlias=filterField.Alias==""|filterField.Alias==null?filterField.Name:filterField.Alias,filterField;stateObject[filterFieldName]!=null&&stateObject[filterFieldName].Value!=""&&(filterField={},filterField.FieldType=filterFieldType.toString(),filterField.FieldName=filterFieldAlias.toString(),filterField.FieldValue=stateObject[filterFieldName].Value.toString(),filterFields.push(filterField))});field.Lookup.LookupAttribute_ddlbtype=="dynamic"&&(ds=GetDdlbDataSource(field.Lookup.LookupAttribute_entityname==null?"":field.Lookup.LookupAttribute_entityname,field.Lookup.LookupAttribute_queryname==null?"":field.Lookup.LookupAttribute_queryname,field.Lookup.LookupAttribute_module==null?"":field.Lookup.LookupAttribute_module,sortCriteria,filterFields,field.Lookup.LookupAttribute_enableemptyvalue==null?!0:field.Lookup.LookupAttribute_enableemptyvalue.toString().toLowerCase()=="true",field.Lookup.LookupAttribute_keyvalue,field.Lookup.LookupAttribute_displayvalue),emptyDataSource=new kendo.data.DataSource({data:[]}),ddlbControl.setDataSource(ds));ddlbControl.bind("change",function(){switch(sourceScreen.toLowerCase()){case"new":$scope.ScreenData.NewEntities[module].Data[0][field.Name].Value=ddlbControl.value();break;case"maint":$scope.ScreenData[module].Rows[rowIndex][field.Name].Value=ddlbControl.value();break;case"xref":$scope.Xref.entityMaint[field.Name].Value=ddlbControl.value();break;case"new-xref":case"promptwindow":stateObject[field.Name].Value=$scope.Xref.entityNew[field.Name].Value=ddlbControl.value();break;case"maint-action":stateObject=$scope.ActionsData[field.Name].Value=ddlbControl.value();break;case"qbe-action":stateObject=$scope.ActionsData[field.Name].Value=ddlbControl.value();break;case"card":$scope.CardData[field.Name].Value=ddlbControl.value()}});defaultResetValue!=undefined&&(ddlbControl.value(defaultResetValue),ddlbControl.trigger("change"));field.Lookup.ResetFields!=null&&field.Lookup.ResetFields.length>0&&ddlbControl.bind("change",function(){$.each(field.Lookup.ResetFields,function(index,resetField){var resetFieldName=resetField.Name,defaultResetValue=FindArrayEntryValueByKey(resetField.Attributes,"Key","defaultresetvalue","Value",""),resetField=pageMetaData.AllFields[resetField.Name];switch(resetField.FieldAttribute_type.toLowerCase()){case"lookup":ResetLookupField(sourceScreen,$scope,module,resetField,rowIndex,defaultResetValue);break;case"ddlb":ResetDdlbField(sourceScreen,$scope,module,resetField,rowIndex,defaultResetValue)}stateObject[resetField.Name].Value!=undefined&&(stateObject[resetField.Name].Value=defaultResetValue);stateObject[resetField.Name]!=undefined&&(stateObject[resetField.Name].Value=defaultResetValue);$scope.$apply()})})}function ExecuteAction($scope,executeAction,callBackFunction,elementToBlock){var dataUrl=baseLink_FrameworkController+"/execute-action";AsteaLogger.WriteToLog("info","FW",kendo.format("start executing action {0} module {1}",executeAction.actionName,executeAction.module),"",!1);Astea.Framework.Ajax.MakeAjaxCall_UpdateData(dataUrl,executeAction,elementToBlock,function(response){AsteaLogger.WriteToLog("info","FW",kendo.format("end executing action {0} module {1}",executeAction.actionName,$scope!=null?$scope.ScreenGlobals.Module:""),"",!1);response.Error!=null?IsSessionTimeoutError(response)?callBackFunction(!1):response.Error.ErrorType=="AsteaException"?showInfoMessage(response.Error.ErrorMessage):response.Error.ErrorCode=="A2LOC002"?showInfoMessage(response.Error.ErrorMessage,function(){$scope!=null&&$scope.Actions.Refresh();callBackFunction(!1)}):(showErrorMessage(response.Error.ErrorMessage),callBackFunction(!1)):executeAction.resultable?callBackFunction(response):callBackFunction(!0)})}function BuildButtonCondition(condition,conditionStatement,fieldType,valueForCondition){if(valueForCondition==null)return conditionStatement;switch(condition.Operator.toLowerCase()){case"eq":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+"=="+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":case"string":case"decimal":conditionStatement+=" '"+valueForCondition+"'=='"+condition.ConditionValue+"' ";condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}break;case"gt":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+">"+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":conditionStatement+=valueForCondition+">"+condition.ConditionValue;condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}break;case"lt":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+"<"+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":case"decimal":conditionStatement+=valueForCondition+"<"+condition.ConditionValue;condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}break;case"ne":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+"!="+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":case"string":conditionStatement+="'"+valueForCondition+"'!='"+condition.ConditionValue+"'";condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}break;case"lt-eq":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+"<="+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":case"decimal":conditionStatement+=valueForCondition+"<="+condition.ConditionValue;condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}break;case"gt-eq":switch(fieldType){case"datetime":case"date":case"time":conditionStatement+=new Date(valueForCondition).getTime()+">="+new Date(condition.ConditionValue).getTime();condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ");break;case"number":conditionStatement+=valueForCondition+">="+condition.ConditionValue;condition.Operand.length>0&&(conditionStatement+=condition.Operand.toLowerCase()=="and"?" && ":" || ")}}return conditionStatement}function ConvertNullToEmptyString(value){return value==null||value=="null"?"":value}function ParseUrlParams(){var str=window.location.search,urlParams={};return str.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function($0,$1,$2,$3){urlParams[$1]=$3}),urlParams}function removeParameter(url,parameter){var fragment=url.split("#"),urlparts=fragment[0].split("?"),i;if(urlparts.length>=2){var urlBase=urlparts.shift(),queryString=urlparts.join("?"),prefix=encodeURIComponent(parameter)+"=",pars=queryString.split(/[&;]/g);for(i=pars.length;i-->0;)pars[i].lastIndexOf(prefix,0)!==-1&&pars.splice(i,1);url=urlBase+"?"+pars.join("&");fragment[1]&&(url+="#"+fragment[1])}return url}function IsNumberKey(evt){var charCode=evt.which?evt.which:event.keyCode;return charCode>31&&(charCode<48||charCode>57)&&charCode!=46&&charCode!=44?!1:!0}function DisableLinkCondition(evalCond){return evalCond}function ConvertConditionByStateValues(condition,stateObject){var fieldArray=condition.split("field");return $.each(fieldArray,function(idx,field){var startIdx=field.indexOf("["),endIdx=field.indexOf("]"),value;startIdx!=-1&&endIdx!=-1&&(field=field.substring(startIdx+1,endIdx),value=stateObject[field]?stateObject[field].Value:stateObject,value!=undefined?condition=$.isNumeric(value)?" "+condition.replace("field["+field+"]",value):" "+condition.replace("field["+field+"]","'"+value+"'"):AsteaLogger.WriteToLog("error","FW",kendo.format("Field condition {0} was not found in state, condition ignored",field),"",!1))}),condition=ConvertConditionOperators(condition)}function ConvertCondition(condition,replaceField,gridColumnTemplate){return gridColumnTemplate==undefined&&(gridColumnTemplate=!1),replaceField==undefined&&(replaceField=""),condition!=undefined?(condition=gridColumnTemplate?condition.split("]").join(""):condition.split("]").join(".Value"),condition=condition.split("field[").join(replaceField)):condition="",ConvertConditionOperators(condition)}function ConvertConditionOperators(condition){return condition==undefined||condition.length==0?"":(condition=condition.split(" lt ").join(" < "),condition=condition.split(" gt ").join(" > "),condition=condition.split(" le ").join(" <= "),condition=condition.split(" ge ").join(" <= "),condition=condition.split(" and ").join(" && "),condition.split(" or ").join(" || "))}function applyCheckboxRowBycondition(dataValue,chkColumnName,chkCondition){return chkCondition=ConvertConditionByStateValues(chkCondition,dataValue),eval(chkCondition)}function ValidateLinkModuleSecurity(orderType,ordersList,fieldVlue){if(fieldVlue==undefined||fieldVlue.length==0)return!1;if(ordersList==undefined||ordersList.length==0||ordersList.contains("null"))return!0;return ordersList.contains(orderType)}function ValidateEmptyNull(fieldVlue){return fieldVlue==undefined||fieldVlue=="undefined"||fieldVlue.length==0?!0:!1}function BuildStateObject(stateData,metaData){var stateObject={},stateRow;return stateData.value&&$.isArray(stateData.value)?$.each(stateData.value,function(idx,row){var stateRow={};$.each(row,function(itemName,itemValue){var fieldType="";metaData.AllFieldsTypes!=undefined&&metaData.AllFieldsTypes[itemName]!=undefined&&metaData.AllFieldsTypes[itemName].FieldAttribute_type!=undefined&&(fieldType=metaData.AllFieldsTypes[itemName].FieldAttribute_type);itemValue==null&&(fieldType.toLowerCase()=="lookup"||fieldType.toLowerCase()=="ddlb")&&(itemValue="");itemValue!=null&&itemValue.hasOwnProperty("Value")&&(itemValue=itemValue.Value);stateRow[itemName]=new StateColumnObject(itemName,itemValue,fieldType)});stateRow.astea_row_status==undefined&&(stateRow.astea_row_status=new StateColumnObject("astea_row_status","",""));stateObject[idx]=stateRow}):(stateRow={},$.each(stateData,function(itemName,itemValue){var fieldType="";metaData.AllFieldsTypes!=undefined&&metaData.AllFieldsTypes[itemName]!=undefined&&metaData.AllFieldsTypes[itemName].FieldAttribute_type!=undefined&&(fieldType=metaData.AllFieldsTypes[itemName].FieldAttribute_type);itemValue==null&&(fieldType.toLowerCase()=="lookup"||fieldType.toLowerCase()=="ddlb")&&(itemValue="");itemValue!=null&&itemValue.hasOwnProperty("Value")&&(itemValue=itemValue.Value);stateRow[itemName]=new StateColumnObject(itemName,itemValue,fieldType)}),stateRow.astea_row_status==undefined&&(stateRow.astea_row_status=new StateColumnObject("astea_row_status","","")),stateObject=stateRow),stateObject}function ConvertStateRowToGridRow(stateRow){return $.each(stateRow,function(itemName,itemValue){itemValue.hasOwnProperty("Value")&&(stateRow[itemName]=itemValue.Value)}),stateRow}function BuildCatalogImagePath(attachmentId,fileName){if(fileName==null||attachmentId==null)return"";var fileWithoutExt=fileName.substr(0,fileName.lastIndexOf("."))||fileName,fileExt=fileName.substr(fileName.lastIndexOf("."),fileName.length);return baseLink_CustomImagesUrl+fileWithoutExt+"_"+attachmentId+fileExt}function OnItemQbeNoImage(imageObject){imageObject.src="../content/images/Common/no_picture.png";$(imageObject).addClass("no-image");imageObject.onerror=""}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function getFieldValue(stateField){return stateField.Type?(stateField.Type==="decimal"||stateField.Type==="number")&&!isNumber(stateField.Value)?null:stateField.Value:stateField.Value}var timer,homePageTimer,dateFormat;window.onerror=function(errorMsg,url,lineNumber){var errorMessage=kendo.format("unexpected system error: {0} page: {1} line: {2}",errorMsg,url,lineNumber);return AsteaLogger.WriteToLog("error","",kendo.format("unexpected system error: {0}",errorMsg),kendo.format("url: {0} ; \r\nline: {1}",url,lineNumber),!1),showErrorMessage(kendo.format("unexpected system error: {0}",errorMsg),null),!0};String.prototype.startsWith=function(pattern){return this.indexOf(pattern)===0};String.prototype.endsWith=function(suffix){return this.indexOf(suffix,this.length-suffix.length)!==-1};String.prototype.contains=function(subString){return this.indexOf(subString)!=-1};String.prototype.replaceAll=function(s1,s2){return this.split(s1).join(s2)};String.prototype.isNullOrWhitespace=function(){return this==null?!0:$.trim(this)==""};String.prototype.trim=function(){return $.trim(this)};String.prototype.asteaParseDate=function(){var date;try{date=kendo.parseDate(this)}catch(e){date=new Date(this)}return date};Number.prototype.asteaParseDate=function(){var date;try{date=kendo.parseDate(this)}catch(e){date=new Date(this)}return date};Date.prototype.addDays=function(days){var dt=new Date(this.valueOf());return dt.setDate(dt.getDate()+days),dt};Date.prototype.addHours=function(h){var dt=new Date(this.valueOf());return dt.setTime(dt.getTime()+h*36e5),dt};$.fn.disable=function(){return this.each(function(){$(this).attr("disabled","disabled")})};$.fn.enable=function(){return this.each(function(){$(this).removeAttr("disabled")})};Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]}),function(factory){typeof define=="function"&&define.amd?define(["jquery"],factory):typeof exports=="object"?factory(require("jquery")):factory(jQuery)}(function($){function encode(s){return config.raw?s:encodeURIComponent(s)}function decode(s){return config.raw?s:decodeURIComponent(s)}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value))}function parseCookieValue(s){s.indexOf('"')===0&&(s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s=decodeURIComponent(s.replace(pluses," ")),config.json?JSON.parse(s):s}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value}var pluses=/\+/g,config=$.cookie=function(key,value,options){var days,t,result,cookies,i,l;if(key.contains("astea_client")||(key=GetTabKey()+"_"+key),value!==undefined&&!$.isFunction(value))return options=$.extend({},config.defaults,options),typeof options.expires=="number"&&(days=options.expires,t=options.expires=new Date,t.setTime(+t+days*864e5)),options.secure==undefined&&(options.secure=!0),document.cookie=[encode(key),"=",stringifyCookieValue(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("");for(result=key?undefined:{},cookies=document.cookie?document.cookie.split("; "):[],i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=parts.join("=");if(key&&key===name){result=read(cookie,value);break}key||(cookie=read(cookie))===undefined||(result[name]=cookie)}return result};config.defaults={};$.removeCookie=function(key,options){return $.cookie(key)===undefined?!1:($.cookie(key,"",$.extend({},options,{expires:-1})),!$.cookie(key))}});dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){for(val=String(val),len=len||2;val.length<len;)val="0"+val;return val};return function(date,mask,utc){var dF=dateFormat;if(arguments.length!=1||Object.prototype.toString.call(date)!="[object String]"||/\d/.test(date)||(mask=date,date=undefined),date=date?new Date(date):new Date,isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]);mask.slice(0,4)=="UTC:"&&(mask=mask.slice(4),utc=!0);var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.AsteaDateFormat=function(mask,utc){return dateFormat(this,mask,utc)}